Things left to do:
- implement RETRY to obtain missing commits; this will probably just be
  done through the SYNC protocol
- maybe don't truncate until some particular time has elapsed, but also
  whatever
- lots and lots of error-handling
